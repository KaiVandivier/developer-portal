<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/dev-portal-demo/blog/rss.xml" title="DHIS2 Developer Portal Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/dev-portal-demo/blog/atom.xml" title="DHIS2 Developer Portal Blog Atom Feed"><title data-react-helmet="true">SameSite Cookie Policies and DHIS2 Applications | DHIS2 Developer Portal</title><meta data-react-helmet="true" property="og:title" content="SameSite Cookie Policies and DHIS2 Applications | DHIS2 Developer Portal"><meta data-react-helmet="true" name="description" content="As of mid-July 2020, the Chrome (and Chromium) stable release channel has started to disable cross-site cookies by default. Mozilla Firefox has pushed this change to their beta channel and will likely release it to the stable channel soon. This change affects any DHIS2 application running on a different domain than the DHIS2 server instance, including applications running on localhost in development. It does not affect cross-site API requests which use Basic or OAuth authentication headers, as those do not rely on cookies for authentication."><meta data-react-helmet="true" property="og:description" content="As of mid-July 2020, the Chrome (and Chromium) stable release channel has started to disable cross-site cookies by default. Mozilla Firefox has pushed this change to their beta channel and will likely release it to the stable channel soon. This change affects any DHIS2 application running on a different domain than the DHIS2 server instance, including applications running on localhost in development. It does not affect cross-site API requests which use Basic or OAuth authentication headers, as those do not rely on cookies for authentication."><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="default"><link data-react-helmet="true" rel="shortcut icon" href="/dev-portal-demo/img/favicon.ico"><link rel="stylesheet" href="/dev-portal-demo/styles.d48d751e.css">
<link rel="preload" href="/dev-portal-demo/styles.d37d7984.js" as="script">
<link rel="preload" href="/dev-portal-demo/runtime~main.a77a56ef.js" as="script">
<link rel="preload" href="/dev-portal-demo/main.b0e916ee.js" as="script">
<link rel="preload" href="/dev-portal-demo/1.ead7ee12.js" as="script">
<link rel="preload" href="/dev-portal-demo/2.2c725a12.js" as="script">
<link rel="preload" href="/dev-portal-demo/01a85c17.cc453086.js" as="script">
<link rel="preload" href="/dev-portal-demo/1be78505.9ca53a07.js" as="script">
<link rel="preload" href="/dev-portal-demo/672ba3d6.8f18f33c.js" as="script">
<link rel="preload" href="/dev-portal-demo/6875c492.e2dac05b.js" as="script">
<link rel="preload" href="/dev-portal-demo/801ffb83.c90c26f0.js" as="script">
<link rel="preload" href="/dev-portal-demo/a6aa9e1f.9d470077.js" as="script">
<link rel="preload" href="/dev-portal-demo/c4f5d8e4.24152359.js" as="script">
<link rel="preload" href="/dev-portal-demo/ccc49370.6142be9d.js" as="script">
<link rel="preload" href="/dev-portal-demo/40.560a3c07.js" as="script">
<link rel="preload" href="/dev-portal-demo/e509ae97.221a2562.js" as="script">
<link rel="preload" href="/dev-portal-demo/284c8978.c6eacb82.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/dev-portal-demo/"><img src="/dev-portal-demo/img/dhis2developers.svg" alt="DHIS2 Developer Portal" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/dev-portal-demo/img/dhis2developers.svg" alt="DHIS2 Developer Portal" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"></a><a class="navbar__item navbar__link" href="/dev-portal-demo/docs/">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/dev-portal-demo/blog">Blog</a><a class="navbar__item navbar__link" href="/dev-portal-demo/events">Events</a><a class="navbar__item navbar__link" href="/dev-portal-demo/community">Community</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/dev-portal-demo/"><img src="/dev-portal-demo/img/dhis2developers.svg" alt="DHIS2 Developer Portal" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/dev-portal-demo/img/dhis2developers.svg" alt="DHIS2 Developer Portal" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/dev-portal-demo/docs/">Docs</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/dev-portal-demo/blog">Blog</a></li><li class="menu__list-item"><a class="menu__link" href="/dev-portal-demo/events">Events</a></li><li class="menu__list-item"><a class="menu__link" href="/dev-portal-demo/community">Community</a></li><li class="menu__list-item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper blog-wrapper"><div class="container margin-vert--lg"><div class="row"><div class="col col--2"><div class="sidebar_SWld thin-scrollbar"><h3 class="sidebarItemTitle_Km2m">Recent posts</h3><ul class="sidebarItemList_3UpA"><li class="sidebarItem_2T0D"><a aria-current="page" class="sidebarItemLink_v5H9 sidebarItemLinkActive_1anX" href="/dev-portal-demo/blog/cross-origin-cookies">SameSite Cookie Policies and DHIS2 Applications</a></li><li class="sidebarItem_2T0D"><a class="sidebarItemLink_v5H9" href="/dev-portal-demo/blog/ui-5-release">ui 5 release</a></li></ul></div></div><main class="col col--8"><article><header><h1 class="margin-bottom--sm blogPostTitle_3-lP">SameSite Cookie Policies and DHIS2 Applications</h1><div class="margin-vert--md"><time datetime="2020-08-10T00:00:00.000Z" class="blogPostDate_Ta7i">August 10, 2020  Â· 5 min read</time></div><div class="avatar margin-vert--md"><a class="avatar__photo-link avatar__photo" href="https://github.com/amcgee" target="_blank" rel="noreferrer noopener"><img src="https://avatars.githubusercontent.com/u/947888?s=400&amp;u=2051953d3237171aee830b7b3ee266a10995dcb2&amp;v=4" alt="Austin McGee"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/amcgee" target="_blank" rel="noreferrer noopener">Austin McGee</a></h4><small class="avatar__subtitle"></small></div></div></header><section class="markdown"><p>As of mid-July 2020, the Chrome (and Chromium) stable release channel <a href="https://www.chromium.org/updates/same-site" target="_blank" rel="noopener noreferrer">has started to disable cross-site cookies by default</a>. Mozilla Firefox has pushed this change to their <a href="https://hacks.mozilla.org/2020/08/changes-to-samesite-cookie-behavior/" target="_blank" rel="noopener noreferrer">beta channel and will likely release it to the stable channel soon</a>. This change affects any DHIS2 application running <strong>on a different domain than the DHIS2 server instance</strong>, including applications running on localhost in development. It does not affect cross-site API requests which use Basic or OAuth authentication headers, as those do not rely on cookies for authentication.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="what-is-the-samesite-cookie-attribute"></a>What is the SameSite Cookie attribute?<a class="hash-link" href="#what-is-the-samesite-cookie-attribute" title="Direct link to heading">#</a></h2><p>Basically, browsers are starting to block, by default, most cookies (which typically contain sensitive information such as login session tokens) to a domain which does not match the current URL of the site visited in the browser. The SERVER (not the browser) must set a specific attribute on the cookie (called <code>SameSite</code> to have the value <code>None</code>) if the cookie is safe to include in cross-domain requests. The attribute <code>Secure</code>, which requires that the cookie only be sent over encrypted HTTPS connections, MUST also be set on the Cookie because <a href="https://web.dev/samesite-cookies-explained/#samesitenone-must-be-secure" target="_blank" rel="noopener noreferrer">it is now required for <code>SameSite=None</code> cookies</a>. DHIS2 does not set these attributes on its authentication cookies. As of mid-July, popular browsers like Chrome and Firefox are beginning to enforce these rules.</p><p>Confused? <a href="https://web.dev/samesite-cookies-explained/" target="_blank" rel="noopener noreferrer">Learn more here</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="how-does-this-affect-dhis2"></a>How does this affect DHIS2?<a class="hash-link" href="#how-does-this-affect-dhis2" title="Direct link to heading">#</a></h2><p>The vast majority of DHIS2 users and implementers will not be affected by this issue. DHIS2 applications which are directly installed into a DHIS2 instance (either core applications or custom ones installed through the App Management app) will continue to work without any interruptions.</p><p>However, applications running on <strong>another server under a different domain</strong> will stop functioning in browsers which implement this new security feature. The most common place this occurs is during application development when your local application (running at <code>http://localhost:3000</code>, for instance) attempts to connect and authenticate with a remote DHIS2 server (running at <code>https://dhis2.myorg.com</code>, for instance). When this happens, authentication will fail and the developer will see repeated HTTP 401 (<code>Error: Unauthorized</code>) errors in the developer console. A warning will also appear, at least in Chrome, similar to the following (it also appears in older versions <strong>which do not yet implement the feature</strong>):</p><blockquote><p>A cookie associated with a cross-site resource at <a href="http://dhis2.org/" target="_blank" rel="noopener noreferrer">http://dhis2.org/</a> was set without the <code>SameSite</code> attribute. A future release of Chrome will only deliver cookies with cross-site requests if they are set with <code>SameSite=None</code> and <code>Secure</code>. You can review cookies in developer tools under Application&gt;Storage&gt;Cookies and see more details at <a href="https://www.chromestatus.com/feature/5088147346030592" target="_blank" rel="noopener noreferrer">https://www.chromestatus.com/feature/5088147346030592</a> and <a href="https://www.chromestatus.com/feature/5633521622188032" target="_blank" rel="noopener noreferrer">https://www.chromestatus.com/feature/5633521622188032</a>.</p></blockquote><p>In very rare cases, a production DHIS2 application might be running on a different domain than the DHIS2 server. If this issue is affecting a production application in your environment <a href="https://jira.dhis2.org" target="_blank" rel="noopener noreferrer">please let us know as soon as possible by opening a Jira ticket!</a></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="how-can-i-work-around-this-for-application-development"></a>How can I work around this for application development?<a class="hash-link" href="#how-can-i-work-around-this-for-application-development" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="using-a-local-dhis2-instance"></a>Using a local DHIS2 instance<a class="hash-link" href="#using-a-local-dhis2-instance" title="Direct link to heading">#</a></h3><p>By far the most secure way to work around this issue during application development is to run a local instance of DHIS2 against which you can test your application. You can easily spin up one or more DHIS2 instances locally using Docker and the <code>d2 cluster</code> command of the <a href="https://cli.dhis2.nu/#/commands/d2-cluster" target="_blank" rel="noopener noreferrer">DHIS2 CLI</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="in-google-chrome-or-chromium-based-browsers"></a>In Google Chrome or Chromium-based browsers<a class="hash-link" href="#in-google-chrome-or-chromium-based-browsers" title="Direct link to heading">#</a></h3><p>It is possible to disable the default SameSite=Lax behavior in Chrome and Chromium by setting the &quot;SameSite by default cookies&quot; flag (chrome://flags/#same-site-by-default-cookies) to <strong>Disabled</strong>. Note that this disables legitimate security behaviors in your browser, so proceed with caution! We recommend that you only disable this flag when actively debugging a DHIS2 application</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="in-mozilla-firefox"></a>In Mozilla Firefox<a class="hash-link" href="#in-mozilla-firefox" title="Direct link to heading">#</a></h3><p>Firefox stable channel does not yet enforce this cookie policy, so for the moment everything should continue to work. Currently there doesn&#x27;t appear to be an easy way to disable the policy in Firefox Beta. Stay tuned for updates, and if you find a workaround please share it in the comments below!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="how-can-i-work-around-this-for-production-applications-running-on-a-separate-domain"></a>How can I work around this for production applications running on a separate domain?<a class="hash-link" href="#how-can-i-work-around-this-for-production-applications-running-on-a-separate-domain" title="Direct link to heading">#</a></h2><blockquote><p><strong>NOTE</strong> Applications installed directly on a DHIS2 application (using the DHIS2 App Management app) will be available on the same domain as the DHIS2 instance, and so <strong>are not affected by this issue</strong></p></blockquote><p>If a production application is hosted on a separate server and domain than the DHIS2 instance, and it uses cookies for authentication (the most common setup), it <strong>will be affected</strong> by this issue. In order to restore funtionality to external applications it is necessary to set the <code>SameSite=None; Secure</code> attributes on the DHIS2 authentication cookie and to run the DHIS2 instance with SSL/TLS enabled (so that it is only accessible over HTTPS). DHIS2 does not currently support this behavior by default, so it is necessary to modify the server&#x27;s cookie responses in a gateway such as NGINX or Apache.  If you are hosting a production application outside of your DHIS2 instance and affected by this issue <strong>please reach out to the DHIS2 core team so that we can be made aware of use-cases and can help you work around the issue with a gateway setup</strong></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="will-the-dhis2-core-address-this-long-term"></a>Will the DHIS2 Core address this long-term?<a class="hash-link" href="#will-the-dhis2-core-address-this-long-term" title="Direct link to heading">#</a></h2><p>In short, we aren&#x27;t sure if or how we will change the default behavior or DHIS2 cookie authentication yet. We are evaluating options for secure cross-domain authentication and simplified application development workflows, and will share more when we have more information.</p></section><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/dev-portal-demo/blog/tags/app-platform">app platform</a><a class="margin-horiz--sm" href="/dev-portal-demo/blog/tags/developer-tools">developer tools</a><a class="margin-horiz--sm" href="/dev-portal-demo/blog/tags/webapp">webapp</a><a class="margin-horiz--sm" href="/dev-portal-demo/blog/tags/troubleshooting">troubleshooting</a><a class="margin-horiz--sm" href="/dev-portal-demo/blog/tags/authentication">authentication</a></div></footer></article><div><a href="https://github.com/facebook/docusaurus/edit/master/website/blog/blog/2020-08-10-cross-origin-cookies.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="margin-vert--xl"><nav class="pagination-nav" aria-label="Blog post page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/dev-portal-demo/blog/ui-5-release"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">ui 5 release Â»</div></a></div></nav></div></main><div class="col col--2"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-is-the-samesite-cookie-attribute" class="table-of-contents__link">What is the SameSite Cookie attribute?</a></li><li><a href="#how-does-this-affect-dhis2" class="table-of-contents__link">How does this affect DHIS2?</a></li><li><a href="#how-can-i-work-around-this-for-application-development" class="table-of-contents__link">How can I work around this for application development?</a><ul><li><a href="#using-a-local-dhis2-instance" class="table-of-contents__link">Using a local DHIS2 instance</a></li><li><a href="#in-google-chrome-or-chromium-based-browsers" class="table-of-contents__link">In Google Chrome or Chromium-based browsers</a></li><li><a href="#in-mozilla-firefox" class="table-of-contents__link">In Mozilla Firefox</a></li></ul></li><li><a href="#how-can-i-work-around-this-for-production-applications-running-on-a-separate-domain" class="table-of-contents__link">How can I work around this for production applications running on a separate domain?</a></li><li><a href="#will-the-dhis2-core-address-this-long-term" class="table-of-contents__link">Will the DHIS2 Core address this long-term?</a></li></ul></div></div><div id="comment-system"></div></div></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/dev-portal-demo/docs/">Style Guide</a></li><li class="footer__item"><a class="footer__link-item" href="/dev-portal-demo/docs/doc2/">Second Doc</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">CoP</a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/dev-portal-demo/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/dev-portal-demo/styles.d37d7984.js"></script>
<script src="/dev-portal-demo/runtime~main.a77a56ef.js"></script>
<script src="/dev-portal-demo/main.b0e916ee.js"></script>
<script src="/dev-portal-demo/1.ead7ee12.js"></script>
<script src="/dev-portal-demo/2.2c725a12.js"></script>
<script src="/dev-portal-demo/01a85c17.cc453086.js"></script>
<script src="/dev-portal-demo/1be78505.9ca53a07.js"></script>
<script src="/dev-portal-demo/672ba3d6.8f18f33c.js"></script>
<script src="/dev-portal-demo/6875c492.e2dac05b.js"></script>
<script src="/dev-portal-demo/801ffb83.c90c26f0.js"></script>
<script src="/dev-portal-demo/a6aa9e1f.9d470077.js"></script>
<script src="/dev-portal-demo/c4f5d8e4.24152359.js"></script>
<script src="/dev-portal-demo/ccc49370.6142be9d.js"></script>
<script src="/dev-portal-demo/40.560a3c07.js"></script>
<script src="/dev-portal-demo/e509ae97.221a2562.js"></script>
<script src="/dev-portal-demo/284c8978.c6eacb82.js"></script>
</body>
</html>